<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlrdyAnimate Test</title>
    <link rel="stylesheet" href="dist/AlrdyAnimate.css">

    <style>

        .button {
            position: relative;
            border-radius: 0.5rem;
            padding: 1rem 2rem;
            background-color: beige;
            display: inline-block;
            overflow: hidden;
            color: #000;
            text-decoration: none;
        }

        [aa-animate*="hover-bg"] svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            color: rgb(0, 0, 0);
        }

        [aa-animate*="hover-bg"] div {
            position: relative;
            z-index: 1;
            transition: color 0.2s ease;
        }

        .button:hover div {
            color: rgb(255, 255, 255)
        }

        .list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-width: 1600px;
        }

        .list_item {
            position: relative;
            cursor: pointer;
            overflow: hidden;
            z-index: 1;
            padding: 1.5rem 2rem;
            color: #000;
            transition: padding-left 0.35s ease;
            border-bottom: 1px solid black;

            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        .list_item:hover{
            color: #ffffff;
            padding-left: 2.5rem;
        }

    </style>

</head>

<body>
    <!-- Curve Button HTML -->
    <a class="button" href="#" aa-animate="hover-bg-curve" aa-hover-direction="all">
        <div>Curve Button</div>
        <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
            <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
        </svg>
    </a>

    <!-- Circle Button HTML -->
    <a class="button" href="#" aa-animate="hover-bg-circle" aa-hover-direction="all">
        <div>Circle Button</div>
        <svg class="bg-filler" viewBox="0 0 1 1" preserveAspectRatio="xMidYMid slice">
            <circle cx="0.5" cy="0.5" r="0" fill="currentColor" />
        </svg>
    </a>


    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    <div class="list">
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 2</div>
            <div>ICON</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
        <div class="list_item" aa-animate="hover-bg-curve" aa-hover-direction="all">
            <div>List Item 1</div>
            <svg class="bg-filler" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M 0 100 V 0 Q 250 0 500 0 V 0 H 0 z" fill="currentColor"></path>
            </svg>
        </div>
    </div>

    


    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>

    <script>
        function initializeAnimations() {
            // First define the SVG paths that both animations will use
            const svgStartFromTop = 'M 0 100 V 0 Q 50 0 100 0 V 0 H 0 z'
            const svgEndFromTop = 'M 0 100 V 100 Q 50 125 100 100 V 0 H 0 z'
            const svgStartFromBottom = 'M 0 100 V 100 Q 75 50 100 100 V 100 z'
            const svgEndFromBottom = 'M 0 100 V 0 Q 50 0 100 0 V 100 z'

            const svgStartToTop = 'M 0 100 V 100 Q 50 50 100 100 V 0 H 0 z'
            const svgEndToTop = 'M 0 100 V 0 Q 50 0 100 0 V 0 H 0 z'
            const svgStartToBottom = 'M 0 100 V 0 Q 50 50 100 0 V 100 z'
            const svgEndToBottom = 'M 0 100 V 100 Q 50 100 100 100 V 100 z'

            const svgStartFromLeft = 'M 0 0 H 0 Q 0 50 0 100 H 0 V 0 z'
            const svgEndFromLeft = 'M 0 0 H 100 Q 110 50 100 100 H 0 V 0 z'
            const svgStartFromRight = 'M 100 0 H 100 Q 100 50 100 100 H 100 V 0 z'
            const svgEndFromRight = 'M 100 0 H 0 Q -10 50 0 100 H 100 V 0 z'

            const svgStartToLeft = 'M 0 0 H 100 Q 75 50 100 100 H 0 V 0 z'
            const svgEndToLeft = 'M 0 0 H 0 Q 0 50 0 100 H 0 V 0 z'
            const svgStartToRight = 'M 100 0 H 0 Q 25 50 0 100 H 100 V 0 z'
            const svgEndToRight = 'M 100 0 H 100 Q 100 50 100 100 H 100 V 0 z'

            

            // Helper functions used by both animations
            function getMouseEnterDirection(mouseEvent, item) {
                const rect = item.getBoundingClientRect()
                const edges = {
                    top: Math.abs(rect.top - mouseEvent.clientY),
                    bottom: Math.abs(rect.bottom - mouseEvent.clientY),
                    left: Math.abs(rect.left - mouseEvent.clientX),
                    right: Math.abs(rect.right - mouseEvent.clientX),
                }
                return Object.keys(edges).find(key => edges[key] === Math.min(...Object.values(edges)))
            }

            function getValidDirection(mouseDirection, allowedDirections) {
                switch (allowedDirections) {
                    case 'all':
                        return mouseDirection;
                    case 'vertical':
                        return ['top', 'bottom'].includes(mouseDirection) ? mouseDirection : 'bottom';
                    case 'horizontal':
                        return ['left', 'right'].includes(mouseDirection) ? mouseDirection : 'left';
                    case 'bottom':
                        return 'bottom';
                    case 'top':
                        return 'top';
                    case 'left':
                        return 'left';
                    case 'right':
                        return 'right';
                    default:
                        return 'bottom'; // Default fallback
                }
            }

            function handleHoverIn(mouseDirection, hoverDirection = 'all') {
                const validDirection = getValidDirection(mouseDirection, hoverDirection);
                const useAllDirections = hoverDirection === 'all';

                const paths = useAllDirections
                    ? {
                        top: { start: svgStartFromTop, end: svgEndFromTop },
                        bottom: { start: svgStartFromBottom, end: svgEndFromBottom },
                        left: { start: svgStartFromLeft, end: svgEndFromLeft },
                        right: { start: svgStartFromRight, end: svgEndFromRight },
                    }
                    : {
                        top: { start: svgStartFromTop, end: svgEndFromTop },
                        bottom: { start: svgStartFromBottom, end: svgEndFromBottom },
                        left: { start: svgStartFromLeft, end: svgEndFromLeft },
                        right: { start: svgStartFromRight, end: svgEndFromRight },
                    }
                return paths[validDirection] || paths.bottom;
            }

            function handleHoverOut(mouseDirection, hoverDirection = 'all') {
                const validDirection = getValidDirection(mouseDirection, hoverDirection);
                const useAllDirections = hoverDirection === 'all';

                const paths = useAllDirections
                    ? {
                        top: { start: svgStartToTop, end: svgEndToTop },
                        bottom: { start: svgStartToBottom, end: svgEndToBottom },
                        left: { start: svgStartToLeft, end: svgEndToLeft },
                        right: { start: svgStartToRight, end: svgEndToRight },
                    }
                    : {
                        top: { start: svgStartToTop, end: svgEndToTop },
                        bottom: { start: svgStartToBottom, end: svgEndToBottom },
                        left: { start: svgStartToLeft, end: svgEndToLeft },
                        right: { start: svgStartToRight, end: svgEndToRight },
                    }
                return paths[validDirection] || paths.bottom;
            }

            function animateHover(element, start, end) {
                if (start && end) {
                    return gsap.fromTo(
                        element,
                        { attr: { d: start } },
                        {
                            attr: { d: end },
                            duration: 0.5,
                            ease: 'power3.out',
                        }
                    )
                }
            }

            // Initialize button animations
            const buttons = document.querySelectorAll('[aa-animate*="hover-bg"]')

            if (buttons && buttons.length > 0) {
                buttons.forEach(button => {
                    const bg = button.querySelector('svg')
                    const bgPath = bg.querySelector('path, circle')
                    const text = button.querySelector(':scope > div')
                    const animStyle = button.getAttribute('aa-animate').includes('circle') ? 'circle' : 'curve'
                    const hoverDirection = button.getAttribute('aa-hover-direction') || 'all'

                    function updateCirclePosition(event, button, circle) {
                        const rect = button.getBoundingClientRect()
                        const x = ((event.clientX - rect.left) / rect.width) * 100
                        const y = ((event.clientY - rect.top) / rect.height) * 100

                        circle.setAttribute('cx', x)
                        circle.setAttribute('cy', y)
                    }

                    function handleCurveAnimation(event, isEnter) {
                        const mouseDirection = getMouseEnterDirection(event, button)
                        const pathDirection = isEnter ?
                            handleHoverIn(mouseDirection, hoverDirection) :
                            handleHoverOut(mouseDirection, hoverDirection)

                        animateHover(bgPath, pathDirection.start, pathDirection.end)
                    }

                    function handleCircleAnimation(event, isEnter) {
                        const rect = button.getBoundingClientRect()
                        const offset = 10 // offset
                        const buttonDiagonal = Math.sqrt(Math.pow(rect.width, 2) + Math.pow(rect.height, 2))
                        const finalRadius = (buttonDiagonal / rect.width) * 1.3

                        // Get mouse direction and validate against allowed directions
                        const mouseDirection = getMouseEnterDirection(event, button)
                        const validDirection = getValidDirection(mouseDirection, hoverDirection)

                        // Calculate mouse position 
                        let x = (event.clientX - rect.left) / rect.width
                        let y = (event.clientY - rect.top) / rect.height

                        // Adjust position based on validated direction to ensure it starts from edge
                        switch (validDirection) {
                            case 'left':
                                x = -offset / rect.width
                                break
                            case 'right':
                                x = 1 + offset / rect.width
                                break
                            case 'top':
                                y = -offset / rect.height
                                break
                            case 'bottom':
                                y = 1 + offset / rect.height
                                break
                            default:
                                y = 1 + offset / rect.height // Default to bottom
                        }

                        bgPath.setAttribute('cx', x)
                        bgPath.setAttribute('cy', y)

                        if (isEnter) {
                            gsap.fromTo(bgPath,
                                { attr: { r: 0 } },
                                {
                                    attr: { r: finalRadius },
                                    duration: 1,
                                    ease: 'power3.out'
                                }
                            )
                        } else {
                            gsap.to(bgPath, {
                                attr: { r: 0 },
                                duration: 1,
                                ease: 'power3.out'
                            })
                        }
                    }

                    button.addEventListener('mouseenter', event => {
                        if (animStyle === 'circle') {
                            handleCircleAnimation(event, true)
                        } else {
                            handleCurveAnimation(event, true)
                        }
                    })

                    button.addEventListener('mouseleave', event => {
                        if (animStyle === 'circle') {
                            handleCircleAnimation(event, false)
                        } else {
                            handleCurveAnimation(event, false)
                        }
                    })
                })
            }

            
        }

        // Initialize everything
        initializeAnimations()

    </script>
</body>