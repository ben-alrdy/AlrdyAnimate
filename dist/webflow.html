<!-- Include the AlrdyAnimate JS -->
<script src="https://cdn.jsdelivr.net/gh/ben-alrdy/AlrdyAnimate@master/docs/v2.0.0/AlrdyAnimate.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/Draggable.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('DOM Content Loaded, initializing AlrdyAnimate...');
  AlrdyAnimate.init({
    easing: 'ease-in-out',
    again: false,
    useGSAP: true
  }).then(({ gsap, ScrollTrigger }) => {
    console.log('AlrdyAnimate init completed. GSAP:', gsap, 'ScrollTrigger:', ScrollTrigger);
    if (gsap && ScrollTrigger) {
      console.log('GSAP and ScrollTrigger are available, initializing Before/After...');
      initializeBeforeAfter(gsap, ScrollTrigger);
    } else {
      console.error('GSAP or ScrollTrigger not available');
    }
  }).catch(error => {
    console.error('Error during AlrdyAnimate initialization:', error);
  });
});

function initializeBeforeAfter(gsap) {
  const beforeAfterWrap = $('.before-after-wrap');
  const afterImgWrap = beforeAfterWrap.find('.img-wrap.is-after');
  const dragger = beforeAfterWrap.find('.dragger');
  
  gsap.registerPlugin(Draggable);

  Draggable.create(dragger, {
    type: 'x',
    bounds: beforeAfterWrap,
    onDrag: function () {
      let x = beforeAfterWrap.width() * 0.98 - gsap.getProperty(this.target, 'x');
      gsap.set(afterImgWrap, { clipPath: `inset(0px ${x}px 0px 0px)` });
    },
  });
}
</script>